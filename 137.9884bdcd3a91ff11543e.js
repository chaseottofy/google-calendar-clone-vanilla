"use strict";(self.webpackChunkgoogle_calendar_clone_vanilla=self.webpackChunkgoogle_calendar_clone_vanilla||[]).push([[137],{137:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var o=n(827),s=n(151),d=n(634),a=n(375),r=n(748),i=n(340),c=n(255),l=n(287),u=n(944),m=n(683);const p=document.querySelector(".dayview--header-day__title"),g=document.querySelector(".dayview--header-day__number"),y=document.querySelector(".dayview--header-day__info"),v=document.querySelector(".dayview--ontop-container"),b=document.querySelector(".calendar__dayview"),x=document.querySelector(".dayview__grid"),f=document.querySelector(".dayview--main-grid");function h(e,t,n){const h=e.getDate();let _=null,C=null,w=null;function E(e){let t=0,n=100;for(let o=0;o<e.length;o++){const[s,d]=[e[o].coordinates.y,e[o].coordinates.e];d>t&&(t=d),s<n&&(n=s)}const[o,s]=[Math.floor(n/4),Math.floor(t/4)],[a,r]=[n%4*15,t%4*15],[i,c]=[new Date(e[0].start),new Date(e[0].start)];return i.setHours(o),i.setMinutes(a),c.setHours(s),c.setMinutes(r),(0,d.VT)(i,c)}function L(){for(const e of[p,g,y])e.innerText="";let t=(new Date).getTimezoneOffset()/60;t<0&&(t=`+${Math.abs(t)}`),document.querySelector(".dv-gmt").textContent=`UTC ${e.getGmt()}`;const n=e.getDay();g.textContent=n,e.isToday()?(g.classList.add("dayview--header-day__number--today"),p.style.color="var(--primary1)"):(g.classList.remove("dayview--header-day__number--today"),p.removeAttribute("style")),p.textContent=s.Z.labels.weekdaysShort[e.getWeekday()].toUpperCase(),y.textContent=function(){const e=C.getAllBoxes();if(0===e.length)return"no entries";let t,[n,o]=[0,0];const s=h.getDate();for(let d=0;d<e.length;d++){const[a,r]=[new Date(e[d].start),new Date(e[d].end)];a.getDate()===s&&o++,r.getDate()===s&&(n++,t=e[d])}if(1===o&&1===n)return`1 entry ( ${(0,d.VT)(new Date(e[0].start),new Date(e[0].end))} )`;if(o>1&&o===n)return`${o} entries starting & ending today ( ${E(C.boxes)} )`;let a="";return a+=o>0?1===o?`${o} entry starting today`:`${o} entries started`:"no entries started",a+=n>0?1===n?` – ${n} ending ( ${(0,d.VT)(new Date(t.start),new Date(t.end))} )`:` – ${n} ending ( ${E(C.boxes)} )`:" – no entries ending today",a}()}function D(){f.innerText="",v.innerText="",y.innerText="",b.onmousedown=null,_=null,C=null,w=null}function k(o,s){const a=o.target,i=a.getAttribute("data-sdvt-id"),c=t.getEntry(i),p=c.start,g=t.getCtgColor(c.category),y=a.getBoundingClientRect(),[v,b]=(0,r.placePopup)(400,165,[Number.parseInt(y.left),Number.parseInt(y.top)+24],[window.innerWidth,window.innerHeight],!1);t.setFormResetHandle("day",s||(()=>{console.log("reset")}));const x=new u.Z;x.setSubmission("edit",i,c.title,c.description),x.setCategory(c.category,g),x.setDates((0,d.cF)(p,c.end)),l.Z.setFormDatepickerDate(e,n,p);(0,m.Z)(e,t,c,n,(()=>l.Z.getConfig(x.getSetup())));const f=document.querySelector(".entry__options");f.style.top=+b+"px",f.style.left=+v+"px"}function T(e){if(document.createElement("div").classList.add("dv--ontop__grid"),e.length>6){const t=document.createElement("div");return t.classList.add("dv--ontop__more"),t.textContent=`${e.length} more...`,void v.append(t)}!function(e){const n=document.createElement("div");n.classList.add("dayview--ontop__grid");for(const o of e){const e=document.createElement("div");e.classList.add("dayview--ontop__grid-item"),e.textContent=o.title,e.style.backgroundColor=t.getCtgColor(o.category),e.setAttribute("data-sdvt-id",o.id),n.append(e)}v.append(n)}(e)}function $(){document.querySelector(".dayview-temp-box")?.remove()}function S(o){(0,a.iE)("dragstart",x,t),document.body.style.cursor="move";const[s,r]=t.getFirstActiveCategoryKeyPair(),i=document.createElement("div");i.setAttribute("class","dv-box dv-box-dragging dayview-temp-box");const m=(0,a.E_)("day"),p=document.createElement("div"),g=document.createElement("span"),y=document.createElement("span");p.classList.add("dv-box__content"),g.classList.add("dv-box-time"),y.classList.add("dv-box-time");const v=Number.parseInt(x.offsetTop),b=Number.parseInt(x.scrollTop),f=o.pageY-v,_=12.5*Math.round((f+Math.abs(b))/12.5);i.setAttribute("style",(0,a.ZB)(_,r));const C={y:+_/12.5,x:1,h:1,e:2};let[w,E,L,D]=(0,a.Xd)(_),k=0;function T(e){k+=e.movementY;let t=12.5*Math.round((e.pageY+b-_-v)/12.5);t<=12.5&&(t=12.5),t+_>1188&&(t=1187.5-_),i.style.height=`${t}px`,C.h=+t/12.5,C.e=+C.y+C.h,L=(0,a.zW)(t,_),D=(0,a.Kd)(t,_),g.style.wordBreak="break-word",g.textContent=`${(0,c.mr)(w,E)} – `,y.textContent=`${(0,c.mr)(L,D)}`}p.append(g,y),i.append(m,p),o.target.append(i),document.addEventListener("mousemove",T),document.addEventListener("mouseup",(function o(){k<=20&&(+C.y>=92?(C.y=92,C.e=95,C.h=3,i.style.height="37.5px",i.style.top="1150px",[w,E]=[23,0],[L,D]=[23,45],g.textContent=`${(0,c.mr)(w,E)} – `,y.textContent=`${(0,c.mr)(L,D)}`):(C.y=4*w,C.e=+C.y+4,C.h=4,i.style.height="50px",i.style.top=12.5*+C.y+"px",E=0,[L,D]=[w+1,0],g.textContent=`${(0,c.mr)(w,E)} – `,y.textContent=`${(0,c.mr)(L,D)}`));const m=(0,d.cp)(h,[w,L],[E,D]);!function(o,s,a,r){t.setFormResetHandle("day",$);const i=t.getRenderFormCallback(),c=new u.Z,[m,p,g,y]=r;c.setSubmission(m,p,g,y),"create"===m&&(o.style.opacity=.9);const[v,b]=s;c.setCategory(v,b);const[x,f]=a;c.setDates((0,d.cF)(x,f)),i(),l.Z.setFormDatepickerDate(e,n,x),l.Z.getConfig(c.getSetup())}(i,[s,r],m,["create",null,null,null]),(0,a.iE)("dragend",x,t),document.removeEventListener("mouseup",o),document.removeEventListener("mousemove",T)}))}function A(){!function(){f.innerText="",v.innerText="",T(C.getBoxesTop());for(const e of C.getBoxes()){const n=e.coordinates.y;(null===w||n<w)&&(w=n),(0,a.dO)(f,e,"day",t.getCtgColor(e.category))}}(),(0,a.ZP)(null,"day",C)}function Z(o){const s=(0,r.getClosest)(o,".dv-box-resize-s"),p=(0,r.getClosest)(o,".dv-box"),g=(0,r.getClosest)(o,".dayview--main-grid"),y=(0,r.getClosest)(o,".dayview--ontop__grid-item"),b=(0,r.getClosest)(o,".dv--ontop__more");s?function(e,n){(0,a.iE)("dragstart",x,t),document.body.style.cursor="move";const o=n.parentElement;let s=!1;const d=(0,a.gn)(n);n.classList.contains("dv-box-ontop")&&(s=!0,(0,a.mg)("day",n)),n.classList.add("dv-box-resizing");const r=n.offsetTop,i=Number.parseInt(x.offsetTop);(0,a.Ly)(n,o,s,"day");const l=Number.parseInt(x.scrollTop),u=e=>{const t=12.5*Math.round((e.pageY+l-r-i)/12.5);t<=12.5?n.style.height="12.5px":t+r>1188||(n.style.height=`${t}px`)};document.addEventListener("mousemove",u),document.addEventListener("mouseup",(function e(){if(document.querySelector(".dv-temporary-box").remove(),n.classList.remove("dv-box-resizing"),s&&n.classList.add("dv-box-ontop"),d.height===n.offsetHeight)(0,a.ft)(n,d);else{(0,a.c4)(n,"day");const e=+n.getAttribute("data-dv-start-time"),o=+n.getAttribute("data-dv-time-intervals"),s=(0,c.ZP)(e,o);n.setAttribute("data-dv-time",s),n.firstChild.nextSibling.firstElementChild.textContent=s,(0,a.nF)(n,"day",C),C.updateStore(t,n.getAttribute("data-dv-box-id")),C.getBoxes().length>1?(0,a.ZP)(null,"day",C):n.setAttribute("data-dv-box-index","box-one")}L(),(0,a.iE)("dragend",x,t),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",e)}))}(0,o.target.parentElement):p?function(o,s){(0,a.iE)("dragstart",x,t);const i=s.parentElement;let p=!1;const g=+s.style.top.split("px")[0],y=+s.style.height.split("px")[0],v=o.pageY-Number.parseInt(x.offsetTop),b=+x.getBoundingClientRect().top.toFixed(2),[f,h]=[o.pageX,o.pageY];let[_,w]=[0,0],E=!1;const D=e=>{_=Math.abs(e.clientX-f),w=Math.abs(e.clientY-h),E||(_>3||w>3)&&(E=!0,document.body.style.cursor="move",s.classList.contains("dv-box-ontop")&&(p=!0,(0,a.mg)("day",s)),s.classList.add("dv-box-dragging"),(0,a.Ly)(s,i,p,"day"),_=0,w=0);const t=e.pageY-b,n=t-v;let o=12.5*Math.round((n+g)/12.5);o<0||t<0?o=0:o+y>1188||(s.style.top=`${o}px`)},k=()=>{const o=document?.querySelector(".dv-temporary-box");if(null===o){const o=()=>{(0,a.iE)("dragend",x,t),s.classList.remove("dv-box-clicked")};s.classList.add("dv-box-clicked");const i=s.getAttribute("data-dv-box-id"),c=t.getEntry(i),p=c.start,g=s.style.backgroundColor,y=s.getBoundingClientRect(),[v,b]=(0,r.placePopup)(400,165,[Number.parseInt(y.left)+32,Number.parseInt(y.top)+32],[window.innerWidth,window.innerHeight],!1);t.setFormResetHandle("day",o);const f=new u.Z;f.setSubmission("edit",i,c.title,c.description),f.setCategory(c.category,g),f.setDates((0,d.cF)(p,c.end)),l.Z.setFormDatepickerDate(e,n,p);const h=()=>l.Z.getConfig(f.getSetup());(0,m.Z)(e,t,c,n,h);const _=document.querySelector(".entry__options");window.innerWidth>580?(_.style.top=+b+"px",_.style.left=v+"px"):_.style.top="64px"}else{o.remove(),s.classList.remove("dv-box-dragging"),p&&s.classList.add("dv-box-ontop"),(0,a.c4)(s,"day");const e=+s.getAttribute("data-dv-start-time"),n=+s.getAttribute("data-dv-time-intervals"),d=(0,c.ZP)(e,n);s.setAttribute("data-dv-time",d),s.children[1].children[0].textContent=d,(0,a.nF)(s,"day",C),C.updateStore(t,s.getAttribute("data-dv-box-id")),C.getBoxes().length>1?(0,a.ZP)(null,"day",C):s.setAttribute("data-dv-box-index","box-one"),L(),(0,a.iE)("dragend",x,t)}document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",k)};document.addEventListener("mousemove",D),document.addEventListener("mouseup",k)}(o,o.target):g?S(o,o.target):y?k(o):b&&function(e){t.addActiveOverlay("morepopup");const n=document.createElement("aside");n.classList.add("dv--morepopup__overlay");const o=document.createElement("aside");o.classList.add("dv--morepopup"),o.style.left=`${v.offsetLeft}px`,o.style.top=`${v.offsetTop}px`;const s=document.createElement("div");s.classList.add("dv--morepopup__header");const a=document.createElement("span");a.classList.add("dv--morepopup__title"),a.textContent="Events spanning multiple days";const c=document.createElement("span");c.classList.add("dv--morepopup__close"),c.append((0,i.G0)("var(--white3)")),s.append(a,c);const l=document.createElement("div");l.classList.add("dv--morepopup__body");const u=e=>{const n=document.createElement("div");n.classList.add("dv--morepopup__entry"),n.style.backgroundColor=`${t.getCtgColor(e.category)}`,n.setAttribute("data-sdvt-id",e.id);const o=document.createElement("span");o.classList.add("dv--morepopup__entry-title"),o.textContent=e.title;const s=document.createElement("span");s.classList.add("dv--morepopup__entry-category"),s.textContent=e.category;const a=document.createElement("span");return a.classList.add("dv--morepopup__entry-time"),a.textContent=(0,d.o4)(new Date(e.start),new Date(e.end)).date,n.append(o,s,a),n};for(const t of e){const e=u(t);l.append(e)}const m=()=>{n.remove(),o.remove(),t.removeActiveOverlay("morepopup"),document.removeEventListener("keydown",p),n.onclick=null,c.onclick=null,l.onclick=null},p=e=>{"Escape"!==e.key||m()};o.append(s,l),document.body.prepend(n,o),n.onclick=m,c.onclick=m,l.onclick=function(e){(0,r.getClosest)(e,".dv--morepopup__entry")&&k(e,m)},document.addEventListener("keydown",p)}(C.getBoxesTop())}_=t.getDayEntries(h),C=new o.Jc(_.day,_.allDay),A(),L(),b.onmousedown=Z,t.setResetPreviousViewCallback(D),function(){if(null!==w){const e=12.5*+w;setTimeout((()=>{x.scrollTo({top:e,behavior:"instant"})}),4)}else{const e=50*(new Date).getHours();setTimeout((()=>{x.scrollTo({top:e-25<=0?0:e-25,behavior:"smooth"})}),4)}}()}}}]);