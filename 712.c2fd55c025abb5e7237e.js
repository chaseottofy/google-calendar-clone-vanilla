"use strict";(self.webpackChunkgoogle_calendar_clone_vanilla=self.webpackChunkgoogle_calendar_clone_vanilla||[]).push([[712],{712:(t,e,n)=>{n.r(e),n.d(e,{default:()=>f});var o=n(432);const s=class{constructor(t){this.flag=t,this.tops=[20,20],this.heights=[18,18]}updateFlag(){this.flag=window.innerWidth<=530||window.innerHeight<=470}getFlag(){return this.flag}getTop(){const[t,e]=this.tops;return this.flag?t:e}getHeight(){const[t,e]=this.heights;return this.flag?t:e}getPrevTop(t){const[e,n]=this.tops;return t===e?n:e}};var a=n(151),i=n(634),r=n(375),d=n(748),l=n(340),c=n(287),m=n(944),u=n(683),p=n(611);const h=document.querySelector(".resize-overlay"),g=document.querySelector(".sidebar"),v=document.querySelector(".monthview--calendar");function f(t,e,n){const f=new s(window.innerWidth<=530||window.innerHeight<=470),y=t.getMonth(),w=t.getDateSelected();function b(){g.classList.contains("hide-sidebar")||(n.resetDate(),t.setDateSelected(t.getDay()),(0,p.Z)(t,e,n))}function L(t){"hide"===t?(h.classList.add("hide-resize-overlay"),e.removeActiveOverlay("hide-resize-overlay")):(h.classList.remove("hide-resize-overlay"),e.addActiveOverlay("hide-resize-overlay"))}function x(){t.setComponent("day"),(0,o.Z)("day",t,e,n),b()}function E(t,n,o,s){const a=document.createElement("div");a.classList.add("monthview--box"),a.setAttribute("data-monthview-id",t),a.style.backgroundColor=e.getCtgColor(n),a.style.top=`${o}px`,a.style.height=`${f.getHeight()}px`,a.style.width="100%";const i=document.createElement("div");return i.classList.add("monthview--title"),i.textContent=s,a.append(i),a}function C(t,e,n,o){const s=[+t.getDay(),Math.floor(e/7)],r=document.createElement("div");r.classList.add("monthview--day"),r.setAttribute("data-mv-date",o),r.setAttribute("data-mv-idx",e),r.setAttribute("data-mv-coordinates",s);const d=document.createElement("button");d.classList.add("monthview--dayofmonth");const l=document.createElement("div");l.classList.add("monthview--daycontent"),t.getMonth()===y&&t.getDate()===w&&d.classList.add("monthview--dayofmonth-selected"),d.append(function(t,e){const{labels:n}=a.Z,o=`${e.getDate()} ${n.monthsShort[e.getMonth()]}`,s=document.createElement("span");return s.classList.add("monthview--daynumber"),e.getMonth()!==y?(s.textContent=o,s.classList.add("monthview--daynumber-prevnext")):1===e.getDate()?s.textContent=o:(0,i.aN)(e,new Date)?(s.textContent=e.getDate(),s.classList.add("monthview--daynumber-today"),t.classList.add("monthview--today")):s.textContent=e.getDate(),s}(r,t));let c=0;if(void 0!==n&&n.length>0)if((n=n.filter((e=>new Date(e.start).getMonth()===t.getMonth()))).length>=6)l.append(function(t,e){const n=document.createElement("div");n.classList.add("monthview--daygroup"),n.setAttribute("data-mvgrouped-date",t),n.setAttribute("data-mvgrouped-length",e);const o=document.createElement("div");o.classList.add("monthview--grouped");const s=document.createElement("div");return s.classList.add("monthview--daycontent__grouped-title"),s.textContent=`${e} more...`,o.append(s),n.append(o),n}(o,n.length)),l.classList.add("monthview--daycontent-grouped");else for(const[e,o]of n.entries())(0,i.aN)(new Date(o.start),t)&&(e>0&&(c+=f.getTop()),l.append(E(o.id,o.category,c,o.title)));r.append(d,l),v.append(r)}function A(){v.innerText="",v.onmousedown=null,v.onclick=null}function D(t){return t.getAttribute("data-mv-coordinates").split(",").map((t=>Number.parseInt(t)))}function _(t,n){const[o,s,a]=(0,i.pH)(t,"data-mv-date","month"),r=n.getAttribute("data-monthview-id"),d=e.getEntry(r),[l,c]=[new Date(d.start),new Date(d.end)],m=new Date(o,s,a),u=(0,i.Z_)(l,m),p=c.getDate()+Math.floor(u/86400)+1;e.updateEntry(r,{start:new Date(o,s,a,l.getHours(),l.getMinutes()),end:new Date(c.getFullYear(),c.getMonth(),p,c.getHours(),c.getMinutes())})}function S(t){t.classList.remove("box-mv-dragactive"),t.style.top="0px",t.style.left="0px",t.style.width="100%",t.style.height=`${f.getHeight()}px`}function k(t,e){if(0!==t.length&&void 0!==t)for(let n=0;n<t.length;n++)void 0===t[n]||null===t[n]||t[n].classList.contains("monthview--box__form-temp")||(t[n].style.top=n*f.getTop()+"px",e?(t[n].classList.add("monthview--box__drop"),setTimeout((()=>{t[n].classList.remove("monthview--box__drop")}),200)):t[n].setAttribute("class","monthview--box"))}function $(o,s){(0,r.iE)("dragstart",v,e);const a=Date.now(),l=s.parentElement,p=l.parentElement;p.classList.add("current-drop-zone");const h=document?.querySelector(".more-modal"),g=l.childElementCount,[y,w]=D(p);!function(t){const e=t.cloneNode(!0);v.prepend(e),e.classList.add("box-mv-dragactive"),e.focus()}(s);const L=document?.querySelector(".box-mv-dragactive");L.setAttribute("data-box-mvx",y),L.setAttribute("data-box-mvy",w);const x=p.getBoundingClientRect(),E=Number.parseFloat(x.width.toFixed(2)),C=Number.parseFloat(x.height.toFixed(2)),A=Number.parseInt(v.offsetLeft),$=s.getBoundingClientRect(),F=Number.parseFloat($.width),N=f.getHeight();L.style.top=`${l.offsetTop}px`,L.style.width=`${F}px`,L.style.height=`${N}px`,L.style.left=`${l.offsetLeft}px`,L.classList.add("hide-mv-clone");const H=v.classList.contains("five-weeks"),[q,T]=[o.clientX,o.clientY];let[Z,z]=[0,0],[I,R]=[y,w],B=!1,Y=!1;const P=t=>{Z=Math.abs(t.clientX-q),z=Math.abs(t.clientY-T),(Z>1||z>1)&&(Y||(h&&h.remove(),document.body.style.cursor="move",Y=!0)),(Z>3||z>3)&&(B||(s.style.opacity="0.5",L.classList.remove("hide-mv-clone")),B=!0);let e=Math.floor((t.clientX-v.offsetLeft)/E);if(e<0)return void(e=0);if(e>6)return void(e=6);if(I!==e){const t=e*E+A;L.style.left=`${Number.parseFloat(t.toFixed(2))}px`,I=e}let n=Math.floor((t.clientY-v.offsetTop)/C);if(n<0)n=0;else if(H&&n>4)n=4;else if(!H&&n>5)n=5;else{if(R!==n){const t=n*C+v.offsetTop+16;L.style.top=`${Number.parseFloat(t.toFixed(2))}px`,R=n}document.querySelector(".current-drop-zone")?.classList.remove("current-drop-zone"),document.querySelector(`[data-mv-coordinates="${e},${n}"]`).classList.add("current-drop-zone")}},W=()=>{const o=document?.querySelector(".current-drop-zone"),p=Date.now()-a,[f,x]=D(o);o.classList.remove("current-drop-zone");const E=o.children[1],C=E?.children;let A=!1;if(null==o)return(0,r.iE)("dragend",v,e),s.style.opacity="1",L.remove(),A=!1,document.removeEventListener("mousemove",P),void document.removeEventListener("mouseup",W);f===y&&x===w?(A=!1,s.style.opacity="1",L.remove(),h&&h.remove(),p<200&&function(o,s){const a=o.getAttribute("data-monthview-id"),r=e.getEntry(a),l=r.start,p=e.getCtgColor(r.category),h=(0,d.v0)(p,.5);s.classList.add("monthview--daycontent__form-temp"),s.style.backgroundColor=h;const g=s.getBoundingClientRect(),[v,f]=(0,d.tb)(360,165,[Number.parseInt(g.left),Number.parseInt(g.top)],[window.innerWidth,window.innerHeight]);e.setFormResetHandle("month",M);const y=new m.Z;y.setSubmission("edit",a,r.title,r.description),y.setCategory(r.category,p),y.setDates((0,i.cF)(l,r.end)),c.Z.setFormDatepickerDate(t,n,l);const w=()=>c.Z.getConfig(y.getSetup());(0,u.Z)(t,e,r,n,w);const b=document.querySelector(".entry__options");b.style.top=f+"px",b.style.left=v+"px"}(s,o)):(A=!0,void 0!==C[0]?C[0].classList.contains("monthview--daygroup")?(!function(t){const e=t.getAttribute("data-mvgrouped-length");t.setAttribute("data-mvgrouped-length",+e+1),t.firstChild.firstChild.textContent=`${t.getAttribute("data-mvgrouped-length")} more...`}(C[0]),_(o,L),L.remove(),s.remove()):(S(L),L.classList.remove("hide-mv-clone"),E.insertBefore(L,C[0]),_(o,L),s.remove(),C.length<=5?k(C,!0):function(t,e,n,o){const s=document.createElement("div");s.classList.add("monthview--daygroup"),s.setAttribute("data-mvgrouped-date",t.getAttribute("data-mv-date")),s.setAttribute("data-mvgrouped-length",n.length);const a=document.createElement("div");a.classList.add("monthview--grouped");const i=document.createElement("div");i.classList.add("monthview--daycontent__grouped-title"),i.textContent=`${n.length} more...`,e.innerText="",s.append(a),a.append(i),e.append(s),e.classList.add("monthview--daycontent-grouped"),o.remove()}(o,E,C,L)):(S(L),s.remove(),L.classList.remove("hide-mv-clone"),E.append(L),_(o,L),b())),A&&(1===g?b():k(l.children,!0)),(0,r.iE)("dragend",v,e),document.removeEventListener("mousemove",P),document.removeEventListener("mouseup",W)};document.addEventListener("mousemove",P),document.addEventListener("mouseup",W)}function F(t){"Escape"===t.key&&N()}function N(){const t=document?.querySelector(".more-modal");t&&t.remove(),L("hide"),document.removeEventListener("keydown",F)}function H(n){const{labels:o}=a.Z,s=function(t){const[n,o,s]=(0,i.pH)(t.target.parentElement.parentElement,"data-mv-date","month");return e.getDayEntriesArray(new Date(n,o,s))}(n);L("show");const r=n.target.parentElement.parentElement,c=document.createElement("div");c.classList.add("more-modal"),c.setAttribute("data-mv-modal",r.getAttribute("data-mv-idx"));let m=28*s.length+64;m>400&&(m=400);const u=r.getBoundingClientRect(),p=Number.parseInt(u.width),[g,f]=(0,d.tb)(216,m,[Number.parseInt(u.left),Number.parseInt(u.top)],[window.innerWidth,window.innerHeight],!0,p),y=+window.innerHeight-+f-24;c.setAttribute("style",`top: ${f}px; left: ${g}px; width: 216px; height: ${m}px; min-height: 120px; max-height: ${y}px;`);const w=document.createElement("div");w.classList.add("more-modal-header");const b=document.createElement("div");b.classList.add("more-modal-header-title");const E=(0,i.RU)(n.target.parentElement.parentElement.getAttribute("data-mv-date")),C=document.createElement("span");C.classList.add("more-modal-header-title-dow"),C.textContent=o.weekdaysShort[E.getDay()].toUpperCase();const A=document.createElement("span");A.classList.add("more-modal-header-title-dayn"),A.textContent=E.getDate();const D=document.createElement("div");D.classList.add("more-modal-header-close"),D.append((0,l.G0)("var(--white3)")),D.setAttribute("data-tooltip","Close"),b.append(D,C,A),w.append(b),c.append(w,function(t){const n=document.createElement("div");n.classList.add("more-modal-content");for(let o=0;o<t.length;o++){const s=t[o],a=document.createElement("div");a.classList.add("more-modal-entry"),a.style.top=22*o+"px",a.style.width="calc(100% - 16px)",a.style.height="20px",a.setAttribute("data-monthview-id",s.id),a.setAttribute("data-mvhidden-category",s.category),a.style.backgroundColor=e.getCtgColor(s.category);const i=document.createElement("div");i.classList.add("more-modal-entry-title"),i.textContent=s.title,a.append(i),n.append(a)}return n}(s)),v.append(c),A.addEventListener("click",(()=>{!function(e){L("hide"),t.setDate(e.getFullYear(),e.getMonth(),e.getDate()),x()}(E)}),{once:!0}),h.addEventListener("click",(()=>{N()}),{once:!0}),document.addEventListener("keydown",F)}function M(){const t=document.querySelector(".monthview--daycontent__form-temp");t&&(t.removeAttribute("style"),t.classList.remove("monthview--daycontent__form-temp"))}function q(){const t=document?.querySelector(".monthview--box__form-temp");if(!t)return;const e=t.parentElement,n=e.parentElement;n.removeAttribute("style"),n.classList.remove("monthview--daycontent__form-temp"),t.remove(),k(e.children,!1)}function T(o,s){if(o.target.classList.contains("monthview--daycontent")){const o=s.parentElement,a=o.getBoundingClientRect(),[r,l]=(0,i.tB)((0,i.pH)(o,"data-mv-date","month"));let u,p;if(0===e.getActiveCategories().length){const t=e.getDefaultCtg();u=t[0],p=t[1].color}else{const t=e.getFirstActiveCategoryKeyPair();u=t[0],p=t[1]}!function(t,e,n,o){const s=E("temp",n,0,"( New Entry )");t.scrollTop=0,s.classList.add("monthview--box__form-temp"),e.classList.add("monthview--daycontent__form-temp"),e.style.backgroundColor=o,t.children.length>0?(t.insertBefore(s,t.children[0]),k(t.children,!1)):t.append(s)}(s,o,u,(0,d.v0)(p,.5)),e.setFormResetHandle("month",q);const h=e.getRenderFormCallback(),g=new m.Z;g.setSubmission("create",null,null,null),g.setCategory(u,p),g.setDates((0,i.cF)(r,l)),h(),c.Z.setFormDatepickerDate(t,n,r),c.Z.getConfig(g.getSetup()),c.Z.setFormStyle(Number.parseInt(a.right),Number.parseInt(a.top),!1,null)}}function Z(e){const n=(0,d.As)(e,".monthview--box"),o=(0,d.As)(e,".monthview--dayofmonth"),s=(0,d.As)(e,".monthview--daygroup"),a=(0,d.As)(e,".more-modal-entry"),r=(0,d.As)(e,".more-modal-header-close");if(n){if(window.innerHeight<=280)return;$(e,e.target)}else{if(o)return e.stopPropagation(),void function(e){const[n,o,s]=(0,i.pH)(e.target.parentElement,"data-mv-date","month");t.setDate(n,o,s),t.setDateSelected(s),x()}(e);if(s)H(e);else if(a){if(window.innerHeight<=300)return;!function(t){const e=document.querySelector(".more-modal"),n=Number.parseInt(e.getAttribute("data-mv-modal")),o=document.querySelector(`[data-mv-idx="${n}"]`),s=t.target.cloneNode(!0);s.setAttribute("class","monthview--box"),s.firstChild.setAttribute("class","monthview--title"),s.style.top=`${f.getTop()}px`,s.style.left="0px",s.style.width="100%",o.lastChild.append(s);const a=o.lastChild.firstChild,i=Number.parseInt(a.getAttribute("data-mvgrouped-length"))-1;i<1?(o.lastChild.classList.remove("monthview--daycontent-grouped"),a.remove(),s.style.top="0px"):(a.setAttribute("data-mvgrouped-length",i),a.firstChild.firstChild.textContent=`${i} more...`),$(t,s),s.focus(),e.style.opacity="0.8"}(e)}else r&&N()}}function z(t){if((0,d.As)(t,".monthview--daycontent")){if(window.innerHeight<=300)return;T(t,t.target)}else;}!function(){v.innerText="";let n=t.getMonthArray(),o=e.getMonthEntries(n),s=e.getGroupedMonthEntries(o);n.length<42?v.classList.add("five-weeks"):v.classList.remove("five-weeks");const a=t=>{const e=s[t.getDate()];return void 0!==e?e:[]};for(const[t,e]of n.entries())C(e,t,a(e),(0,i.OT)(e));n=null,o=null,s=null}(),v.onmousedown=Z,v.onclick=z,e.setResetPreviousViewCallback(A)}}}]);