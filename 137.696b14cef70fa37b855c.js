"use strict";(self.webpackChunkgoogle_calendar_clone_vanilla=self.webpackChunkgoogle_calendar_clone_vanilla||[]).push([[137],{137:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var o=n(827),s=n(151),d=n(634),a=n(375),r=n(748),i=n(340),c=n(255),l=n(287),u=n(944),m=n(683);const p=document.querySelector(".dayview--header-day__title"),y=document.querySelector(".dayview--header-day__number"),g=document.querySelector(".dayview--header-day__info"),v=document.querySelector(".dayview--ontop-container"),b=document.querySelector(".calendar__dayview"),x=document.querySelector(".dayview__grid"),f=document.querySelector(".dayview--main-grid");function h(e,t,n){const h=e.getDate();let _=null,w=null,E=null;function C(e){let t=0,n=100;for(let o=0;o<e.length;o++){const[s,d]=[e[o].coordinates.y,e[o].coordinates.e];d>t&&(t=d),s<n&&(n=s)}const[o,s]=[Math.floor(n/4),Math.floor(t/4)],[a,r]=[n%4*15,t%4*15],[i,c]=[new Date(e[0].start),new Date(e[0].start)];return i.setHours(o),i.setMinutes(a),c.setHours(s),c.setMinutes(r),(0,d.VT)(i,c)}function L(){for(const e of[p,y,g])e.innerText="";let t=(new Date).getTimezoneOffset()/60;t<0&&(t=`+${Math.abs(t)}`),document.querySelector(".dv-gmt").textContent=`UTC ${e.getGmt()}`;const n=e.getDay();y.textContent=n,e.isToday()?(y.classList.add("dayview--header-day__number--today"),p.style.color="var(--primary1)"):(y.classList.remove("dayview--header-day__number--today"),p.removeAttribute("style")),p.textContent=s.Z.labels.weekdaysShort[e.getWeekday()].toUpperCase(),g.textContent=function(){const e=w.getAllBoxes();if(0===e.length)return"no entries";let t,[n,o]=[0,0];const s=h.getDate();for(let d=0;d<e.length;d++){const[a,r]=[new Date(e[d].start),new Date(e[d].end)];a.getDate()===s&&o++,r.getDate()===s&&(n++,t=e[d])}if(1===o&&1===n)return`1 entry ( ${(0,d.VT)(new Date(e[0].start),new Date(e[0].end))} )`;if(o>1&&o===n)return`${o} entries starting & ending today ( ${C(w.boxes)} )`;let a="";return a+=o>0?1===o?`${o} entry starting today`:`${o} entries started`:"no entries started",a+=n>0?1===n?` – ${n} ending ( ${(0,d.VT)(new Date(t.start),new Date(t.end))} )`:` – ${n} ending ( ${C(w.boxes)} )`:" – no entries ending today",a}()}function D(){f.innerText="",v.innerText="",g.innerText="",b.onmousedown=null,_=null,w=null,E=null}function k(o,s){const a=o.target,i=a.getAttribute("data-sdvt-id"),c=t.getEntry(i),p=c.start,y=t.getCtgColor(c.category),g=a.getBoundingClientRect(),[v,b]=(0,r.tb)(400,165,[Number.parseInt(g.left),Number.parseInt(g.top)+24],[window.innerWidth,window.innerHeight],!1);t.setFormResetHandle("day",s||(()=>{console.log("reset")}));const x=new u.Z;x.setSubmission("edit",i,c.title,c.description),x.setCategory(c.category,y),x.setDates((0,d.cF)(p,c.end)),l.Z.setFormDatepickerDate(e,n,p);(0,m.Z)(e,t,c,n,(()=>l.Z.getConfig(x.getSetup())));const f=document.querySelector(".entry__options");f.style.top=+b+"px",f.style.left=+v+"px"}function A(e){if(document.createElement("div").classList.add("dv--ontop__grid"),e.length>6){const t=document.createElement("div");return t.classList.add("dv--ontop__more"),t.textContent=`${e.length} more...`,void v.append(t)}!function(e){const n=document.createElement("div");n.classList.add("dayview--ontop__grid");for(const o of e){const e=document.createElement("div");e.classList.add("dayview--ontop__grid-item"),e.textContent=o.title,e.style.backgroundColor=t.getCtgColor(o.category),e.setAttribute("data-sdvt-id",o.id),n.append(e)}v.append(n)}(e)}function T(){document.querySelector(".dayview-temp-box")?.remove()}function $(o){(0,a.iE)("dragstart",x,t),document.body.style.cursor="move";const[s,r]=t.getFirstActiveCategoryKeyPair(),i=document.createElement("div");i.setAttribute("class","dv-box dv-box-dragging dayview-temp-box");const m=(0,a.E_)("day"),p=document.createElement("div"),y=document.createElement("span"),g=document.createElement("span");p.classList.add("dv-box__content"),y.classList.add("dv-box-time"),g.classList.add("dv-box-time");const v=Number.parseInt(x.offsetTop),b=Number.parseInt(x.scrollTop),f=o.pageY-v,_=12.5*Math.round((f+Math.abs(b))/12.5);i.setAttribute("style",(0,a.ZB)(_,r));const w={y:+_/12.5,x:1,h:1,e:2};let[E,C,L,D]=(0,a.Xd)(_),k=0;function A(e){k+=e.movementY;let t=12.5*Math.round((e.pageY+b-_-v)/12.5);t<=12.5&&(t=12.5),t+_>1188&&(t=1187.5-_),i.style.height=`${t}px`,w.h=+t/12.5,w.e=+w.y+w.h,L=(0,a.zW)(t,_),D=(0,a.Kd)(t,_),y.style.wordBreak="break-word",y.textContent=`${(0,c.mr)(E,C)} – `,g.textContent=`${(0,c.mr)(L,D)}`}p.append(y,g),i.append(m,p),o.target.append(i),document.addEventListener("mousemove",A),document.addEventListener("mouseup",(function o(){k<=20&&(+w.y>=92?(w.y=92,w.e=95,w.h=3,i.style.height="37.5px",i.style.top="1150px",[E,C]=[23,0],[L,D]=[23,45],y.textContent=`${(0,c.mr)(E,C)} – `,g.textContent=`${(0,c.mr)(L,D)}`):(w.y=4*E,w.e=+w.y+4,w.h=4,i.style.height="50px",i.style.top=12.5*+w.y+"px",C=0,[L,D]=[E+1,0],y.textContent=`${(0,c.mr)(E,C)} – `,g.textContent=`${(0,c.mr)(L,D)}`));const m=(0,d.cp)(h,[E,L],[C,D]);!function(o,s,a,r){t.setFormResetHandle("day",T);const i=t.getRenderFormCallback(),c=new u.Z,[m,p,y,g]=r;c.setSubmission(m,p,y,g),"create"===m&&(o.style.opacity=.9);const[v,b]=s;c.setCategory(v,b);const[x,f]=a;c.setDates((0,d.cF)(x,f)),i(),l.Z.setFormDatepickerDate(e,n,x),l.Z.getConfig(c.getSetup())}(i,[s,r],m,["create",null,null,null]),(0,a.iE)("dragend",x,t),document.removeEventListener("mouseup",o),document.removeEventListener("mousemove",A)}))}function S(){!function(){f.innerText="",v.innerText="",A(w.getBoxesTop());for(const e of w.getBoxes()){const n=e.coordinates.y;(null===E||n<E)&&(E=n),(0,a.dO)(f,e,"day",t.getCtgColor(e.category))}}(),(0,a.ZP)(null,"day",w)}function Z(o){const s=(0,r.As)(o,".dv-box-resize-s"),p=(0,r.As)(o,".dv-box"),y=(0,r.As)(o,".dayview--main-grid"),g=(0,r.As)(o,".dayview--ontop__grid-item"),b=(0,r.As)(o,".dv--ontop__more");s?function(e,n){(0,a.iE)("dragstart",x,t),document.body.style.cursor="move";const o=n.parentElement;let s=!1;const d=(0,a.gn)(n);n.classList.contains("dv-box-ontop")&&(s=!0,(0,a.mg)("day",n)),n.classList.add("dv-box-resizing");const r=n.offsetTop,i=Number.parseInt(x.offsetTop);(0,a.Ly)(n,o,s,"day");const l=Number.parseInt(x.scrollTop),u=e=>{const t=12.5*Math.round((e.pageY+l-r-i)/12.5);t<=12.5?n.style.height="12.5px":t+r>1188||(n.style.height=`${t}px`)};document.addEventListener("mousemove",u),document.addEventListener("mouseup",(function e(){if(document.querySelector(".dv-temporary-box").remove(),n.classList.remove("dv-box-resizing"),s&&n.classList.add("dv-box-ontop"),d.height===n.offsetHeight)(0,a.ft)(n,d);else{(0,a.c4)(n,"day");const e=+n.getAttribute("data-dv-start-time"),o=+n.getAttribute("data-dv-time-intervals"),s=(0,c.ZP)(e,o);n.setAttribute("data-dv-time",s),n.firstChild.nextSibling.firstElementChild.textContent=s,(0,a.nF)(n,"day",w),w.updateStore(t,n.getAttribute("data-dv-box-id")),w.getBoxes().length>1?(0,a.ZP)(null,"day",w):n.setAttribute("data-dv-box-index","box-one")}L(),(0,a.iE)("dragend",x,t),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",e)}))}(0,o.target.parentElement):p?function(o,s){(0,a.iE)("dragstart",x,t);const i=s.parentElement;let p=!1;const y=+s.style.top.split("px")[0],g=+s.style.height.split("px")[0],v=o.pageY-Number.parseInt(x.offsetTop),b=+x.getBoundingClientRect().top.toFixed(2),[f,h]=[o.pageX,o.pageY];let[_,E]=[0,0],C=!1;const D=e=>{_=Math.abs(e.clientX-f),E=Math.abs(e.clientY-h),C||(_>3||E>3)&&(C=!0,document.body.style.cursor="move",s.classList.contains("dv-box-ontop")&&(p=!0,(0,a.mg)("day",s)),s.classList.add("dv-box-dragging"),(0,a.Ly)(s,i,p,"day"),_=0,E=0);const t=e.pageY-b,n=t-v;let o=12.5*Math.round((n+y)/12.5);o<0||t<0?o=0:o+g>1188||(s.style.top=`${o}px`)},k=()=>{const o=document?.querySelector(".dv-temporary-box");if(null===o){const o=()=>{(0,a.iE)("dragend",x,t),s.classList.remove("dv-box-clicked")};s.classList.add("dv-box-clicked");const i=s.getAttribute("data-dv-box-id"),c=t.getEntry(i),p=c.start,y=s.style.backgroundColor,g=s.getBoundingClientRect(),[v,b]=(0,r.tb)(400,165,[Number.parseInt(g.left)+32,Number.parseInt(g.top)+32],[window.innerWidth,window.innerHeight],!1);t.setFormResetHandle("day",o);const f=new u.Z;f.setSubmission("edit",i,c.title,c.description),f.setCategory(c.category,y),f.setDates((0,d.cF)(p,c.end)),l.Z.setFormDatepickerDate(e,n,p);const h=()=>l.Z.getConfig(f.getSetup());(0,m.Z)(e,t,c,n,h);const _=document.querySelector(".entry__options");window.innerWidth>580?(_.style.top=+b+"px",_.style.left=v+"px"):_.style.top="64px"}else{o.remove(),s.classList.remove("dv-box-dragging"),p&&s.classList.add("dv-box-ontop"),(0,a.c4)(s,"day");const e=+s.getAttribute("data-dv-start-time"),n=+s.getAttribute("data-dv-time-intervals"),d=(0,c.ZP)(e,n);s.setAttribute("data-dv-time",d),s.children[1].children[0].textContent=d,(0,a.nF)(s,"day",w),w.updateStore(t,s.getAttribute("data-dv-box-id")),w.getBoxes().length>1?(0,a.ZP)(null,"day",w):s.setAttribute("data-dv-box-index","box-one"),L(),(0,a.iE)("dragend",x,t)}document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",k)};document.addEventListener("mousemove",D),document.addEventListener("mouseup",k)}(o,o.target):y?$(o,o.target):g?k(o):b&&function(e){t.addActiveOverlay("morepopup");const n=document.createElement("aside");n.classList.add("dv--morepopup__overlay");const o=document.createElement("aside");o.classList.add("dv--morepopup"),o.style.left=`${v.offsetLeft}px`,o.style.top=`${v.offsetTop}px`;const s=document.createElement("div");s.classList.add("dv--morepopup__header");const a=document.createElement("span");a.classList.add("dv--morepopup__title"),a.textContent="Events spanning multiple days";const c=document.createElement("span");c.classList.add("dv--morepopup__close"),c.append((0,i.G0)("var(--white3)")),s.append(a,c);const l=document.createElement("div");l.classList.add("dv--morepopup__body");const u=e=>{const n=document.createElement("div");n.classList.add("dv--morepopup__entry"),n.style.backgroundColor=`${t.getCtgColor(e.category)}`,n.setAttribute("data-sdvt-id",e.id);const o=document.createElement("span");o.classList.add("dv--morepopup__entry-title"),o.textContent=e.title;const s=document.createElement("span");s.classList.add("dv--morepopup__entry-category"),s.textContent=e.category;const a=document.createElement("span");return a.classList.add("dv--morepopup__entry-time"),a.textContent=(0,d.o4)(new Date(e.start),new Date(e.end)).date,n.append(o,s,a),n};for(const t of e){const e=u(t);l.append(e)}const m=()=>{n.remove(),o.remove(),t.removeActiveOverlay("morepopup"),document.removeEventListener("keydown",p),n.onclick=null,c.onclick=null,l.onclick=null},p=e=>{"Escape"!==e.key||m()};o.append(s,l),document.body.prepend(n,o),n.onclick=m,c.onclick=m,l.onclick=function(e){(0,r.As)(e,".dv--morepopup__entry")&&k(e,m)},document.addEventListener("keydown",p)}(w.getBoxesTop())}_=t.getDayEntries(h),w=new o.Jc(_.day,_.allDay),S(),L(),b.onmousedown=Z,t.setResetPreviousViewCallback(D),function(){if(null!==E){const e=12.5*+E;setTimeout((()=>{x.scrollTo({top:e,behavior:"instant"})}),4)}else{const e=50*(new Date).getHours();setTimeout((()=>{x.scrollTo({top:e-25<=0?0:e-25,behavior:"smooth"})}),4)}}()}}}]);